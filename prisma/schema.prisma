datasource db {
  provider = "postgresql" // or "mysql" if you are using MySQL
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model Customer {
  id       Int      @id @default(autoincrement())
  email    String   @unique
  nom      String
  role     Role     // Enum for admin/client
  phone    String?
  password String   @default("")  // New password field
  orders   Order[]
}

model Product {
  id          Int      @id @default(autoincrement())
  nom         String   @unique
  description String
  image       String   // URL or path to the product image
  prix        String
  type        String[] // Array of types
  barre       String[] // Array of bars
  bases       Base[]   // Relation to the Base model
  tailles     Taille[] // Relation to the Taille model
  orders      Order[]
}

model Base {
  id           Int      @id @default(autoincrement())
  name         String
  image        String   // URL to the image
  price        Float    // Price for this base
  quantity     Int      // Quantity available
  productId    Int
  product      Product  @relation(fields: [productId], references: [id])
}

model Taille {
  id           Int      @id @default(autoincrement())
  name         String
  image        String   // URL to the image
  downloadLink String?  // Optional download link
  price        Float    // Price for this taille
  quantity     Int      // Quantity available
  productId    Int
  product      Product  @relation(fields: [productId], references: [id])
}

model Order {
  id             Int      @id @default(autoincrement())
  orderGroupId   Int      // Group ID to identify products in the same order
  status         String   // 'delivered' or 'pending'
  image          String   // Product image URL or path
  qty            Int      // Total quantity ordered for the product
  email          String   // FK from Customer
  name           String   // FK from Customer's name
  productNom     String   // FK from Product.nom

  // Fields to store specific selections
  selectedType   String?  // Selected value from Product.type
  selectedBase   String?  // Name of the selected base
  baseQuantity   Int?     // Quantity of the selected base
  selectedTaille String?  // Name of the selected taille
  tailleQuantity Int?     // Quantity of the selected taille
  selectedBarre  String?  // Selected value from Product.barre

  product        Product  @relation(fields: [productNom], references: [nom])
  customer       Customer @relation(fields: [email], references: [email])

  @@index([productNom])
  @@index([email])
  @@index([orderGroupId])
}


enum Role {
  admin
  client
}

enum OrderStatus {
  livree
  attente
}
